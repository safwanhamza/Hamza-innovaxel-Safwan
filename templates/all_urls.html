<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Shortened URLs</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <h1>All Shortened URLs</h1>

    {% if error %}
    <p style="color: red;">{{ error }}</p>
    {% else %}
    <table border="1">
        <tr>
            <th>Short URL</th>
            <th>Original URL</th>
            <th>Created At</th>
            <th>Access Count</th>
            <th>Actions</th>
        </tr>
        {% for url in urls %}
        <tr>
            <td><a href="{{ request.host_url }}{{ url.short_code }}" target="_blank">{{ request.host_url }}{{
                    url.short_code }}</a></td>
            <td><a href="{{ url.original_url }}" target="_blank">{{ url.original_url }}</a></td>
            <td>{{ url.created_at }}</td>
            <td>{{ url.access_count }}</td>
            <td>
                <!-- View Stats -->
                <a href="{{ url_for('get_url_stats_page', short_code=url.short_code) }}">View Stats</a>

                <!-- Update Short URL -->
                <form action="{{ url_for('update_short_code_form') }}" method="post" style="display:inline;">
                    <input type="hidden" name="old_short_code" value="{{ url.short_code }}">
                    <input type="text" name="new_short_code" placeholder="New Short Code" required>
                    <button type="submit">Update</button>
                </form>

                <!-- Delete Short URL -->
                <form action="{{ url_for('delete_url_form') }}" method="post" style="display:inline;">
                    <input type="hidden" name="short_code" value="{{ url.short_code }}">
                    <button type="submit"
                        onclick="return confirm('Are you sure you want to delete this short URL?');">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}

    <br>
    <a href="{{ url_for('home') }}">Back to Home</a>
</body>

</html>
